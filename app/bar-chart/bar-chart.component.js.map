{"version":3,"file":"bar-chart.component.js","sourceRoot":"","sources":["bar-chart.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, ElementRef, Input, OnInit, OnChanges, AfterViewInit } from '@angular/core';\n\nimport * as d3 from 'd3';\n\nimport { Margin, TimeSeriesData } from './data';\n\n@Component({\n  moduleId: module.id,\n  selector: 'app-bar-chart',\n  templateUrl: 'bar-chart.component.html'\n})\nexport class BarChartComponent implements OnInit, OnChanges, AfterViewInit {\n\n  @Input()\n  private data:TimeSeriesData[];\n\n  @Input()\n  private width:number;\n\n  @Input()\n  private height:number;\n\n  private container:d3.Selection<any>;\n  // private yAxisWidth = 0;\n\n  private margin:Margin = {\n    left: 55,\n    right: 20,\n    bottom: 30,\n    top: 20\n  }\n\n  private canvas:d3.Selection<any>;\n  private chartArea:d3.Selection<any>;\n  private chartAreaClip:d3.Selection<any>;\n  private chartAreaWidth:number;\n  private chartAreaHeight:number;\n\n  private dataArea:d3.Selection<any>;\n\n  private transitionTime:number = 500;\n\n  private toolTip:d3.Selection<any>;\n\n\n  private xScale:any;\n\n  constructor(private elementRef: ElementRef) {\n    this.container = d3.select(elementRef.nativeElement); \n        // window.addEventListener('resize', e => console.log(e)); // tracks the window size!!!\n\n  }\n\n  ngOnInit() {\n\t  this.canvas = this.container.select('#canvas');\n\n    this.chartArea = this.canvas.append('g')\n      .attr('class', 'chart')\n      .attr('transform', 'translate(' + this.margin.left + \" \" + this.margin.top + ')');\n\n    this.chartAreaWidth = this.width - this.margin.left - this.margin.right;\n    this.chartAreaHeight = this.height - this.margin.top - this.margin.bottom;\n\n    this.chartAreaClip = this.canvas.append('defs').append('clipPath')\n      .attr(\"id\", \"clip\")\n      .append(\"rect\")\n      .attr(\"x\", this.margin.left)\n      .attr(\"y\", this.margin.top)\n      .attr(\"width\", this.chartAreaWidth)\n      .attr(\"height\", this.chartAreaHeight);\n\n    this.dataArea = this.chartArea\n      .append('g')\n      .attr('id', 'data')\n      .attr('clip-path', 'url(#clip)');\n      // .attr('style', \"clip-path: url(#clip);\");\n\n    this.toolTip = d3.select(\"#tooltip\");\n  }\n\n  ngOnChanges() {\n    console.log(\"data changed \" + ( this.data ? this.data.length : 'null'));\n    if (!this.data)\n      return;\n\n    // Scaling Y\n    let values = this.data.map(d => d.value);\n\n    let yScale:d3.scale.Linear<number, number> = d3.scale.linear()\n      .domain( [0, d3.max(values) ])\n      .range([0, this.chartAreaHeight].reverse())\n      .nice();\n\n    let yAxis = d3.svg.axis()\n        .scale(yScale)\n        .ticks(10)\n        .orient(\"left\");\n\n    // Scaling X\n    let dates = this.data.map(d => d.date);\n\n    this.xScale = d3.scale.ordinal()\n      .domain(dates.map(d=>this.toQuarter(d)))\n      .rangeBands([0, this.chartAreaWidth], 0.2);\n\n    /* Using ordinal scales, we cannot use the ticks() method to get a desired\n       number of ticks; D3 will show all of them. A time scale has the issue that\n       our values are ranges, not single dates. Hence, we use a trick to filter\n       out quarters until the desired number is reached. We filter all\n       Q1s and if we still have too many categories, we half the years until the \n       desired maximum is fulfilled.\n     */\n    let desiredMaximumNumberOfTicks = 20;\n    let dateTickValues = dates.map(d=>this.toQuarter(d)).filter(q => q.startsWith(\"Q1\"));\n    while (dateTickValues.length > desiredMaximumNumberOfTicks) {\n      dateTickValues = dateTickValues.filter((q, idx) => idx % 2 != 1);\n    }\n\n    let xAxis = d3.svg.axis()\n      .scale(this.xScale)\n      .tickValues(dateTickValues)\n      .tickFormat(q => q.substr(3))\n      .orient('bottom')\n\n    let bars = this.dataArea\n      .selectAll('rect')\n      .data(this.data, d => d.date.toUTCString());\n\n    // new values get class 'new'\n    bars  \n      .enter()\n      .append('rect')\n      .attr('x', d => this.xScale(this.toQuarter(d.date)))\n      .attr('y', yScale(yScale.domain()[0]))\n      .attr('width', this.xScale.rangeBand())\n      .attr('height', 0)\n      // tooltips\n      .on(\"mouseover\", (datum, index) => {\n        this.toolTip.style('visibility', 'visible');\n        this.toolTip.html(this.toQuarter(datum.date) + \"<br/>\" + datum.value + \" Billion US$\"); \n        let x = +this.dataArea.selectAll('rect').filter(d => d == datum).attr('x') \n        x = x + this.xScale.rangeBand() / 2;\n        let y = +this.dataArea.selectAll('rect').filter(d => d == datum).attr('y');\n        y = this.chartAreaHeight - y + 90;\n        this.toolTip.style('left', x + \"px\");\n        this.toolTip.style('bottom', y + \"px\");\n      })\n      .on(\"mouseout\", (datum) => {\n        this.toolTip\n          .style('visibility', 'hidden');\n      });\n\n    \n    bars\n      .transition()\n      .duration(this.transitionTime)\n      .ease('linear')\n      .attr('x', d => this.xScale(this.toQuarter(d.date)))\n      .attr('y', d => yScale(d.value))\n      .attr('width', this.xScale.rangeBand())\n      .attr('height', d => this.chartAreaHeight - yScale(d.value));\n\n    // add y-Axis\n    this.chartArea.select(\"#y-axis\").remove();\n    this.chartArea\n      .append('g')\n      .attr(\"id\", \"y-axis\")\n      .attr(\"class\", \"axis y\")\n      .call(yAxis);\n\n    // add x-Axis\n    this.chartArea.select(\"#x-axis\").remove();\n    this.chartArea\n      .append('g')\n      .attr(\"id\", \"x-axis\")\n      .attr(\"class\", \"axis x\")\n      .attr(\"transform\", \"translate(0, \" + this.chartAreaHeight + \")\")\n      .call(xAxis);\n\n    // exit values\n    let itemsRemoved = bars.exit().size();\n    let fadeOutLeft = bars.exit().filter((d) => d.date <= this.data[0].date).size() > 0;\n    let newWidthBetweenBars = this.xScale(this.toQuarter(this.data[1].date)) - this.xScale(this.toQuarter(this.data[0].date));\n\n    bars.exit()\n      .transition()\n      .duration(this.transitionTime)\n      .ease('linear')\n      .attr('y', d => yScale(d.value))\n      .attr('height', d => this.chartAreaHeight - yScale(d.value))\n      .attr('x', (d,i) => {\n        // console.log(\"removal...data/index:\" + d + \"/\" + i);\n        let dateOfMiddleItem = this.data[Math.round(this.data.length/2)].date;\n        let dateOfThisItem = d.date;\n        // console.log(\"dates of this/middle: \" + dateOfThisItem.toUTCString() + \"/\" + dateOfMiddleItem.toUTCString())\n        // let fadeOutLeft:boolean = dateOfThisItem <= dateOfMiddleItem;\n        let moveBars = fadeOutLeft ? -(itemsRemoved-i) : i - this.data.length + 1;\n\n        // console.log(\"left?\" + fadeOutLeft);\n        // console.log(\"move bars: \" + moveBars);\n        // console.log(\"xScale: \" + xScale(this.toQuarter(d.date)));\n        // console.log(\"rangeBand: \" + xScale.rangeBand());\n\n        let origin = fadeOutLeft ? 0 : this.chartAreaWidth;\n        return origin + moveBars * newWidthBetweenBars;\n      }\n      )\n      .remove();    \n  }\n\n\n  ngAfterViewInit() {\n    console.log(\"after view init\")\n    console.log(this.elementRef.nativeElement.parentElement.offsetWidth);\n   }\n\n   /**\n    * Converts a Javascript Date into a string representation for it's quarter,\n    * e.g., the date \"1/1/2005\"\" gets converted to \"Q1 2005\".\n    */\n   private toQuarter(date:Date):string {\n     let string = \"Q\";\n     string += (date.getUTCMonth() / 3) + 1;\n     string += \" \";\n     string += date.getUTCFullYear();\n     return string;\n   }\n}\n"]}